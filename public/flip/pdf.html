<html>
<body>
<script src="http://cdnjs.cloudflare.com/ajax/libs/processing.js/1.4.1/processing-api.min.js"></script>
<script src="jQuery-2.1.4.min.js"></script>

<div id="magazine" style="display: none;">
</div>
<input id='pdf' type='file'/>

<!-- Use latest PDF.js build from Github -->
<script type="text/javascript" src="https://rawgithub.com/mozilla/pdf.js/gh-pages/build/pdf.js"></script>
<script type="text/javascript" src="turn.min.js"></script>

<script type="text/javascript">
    //
    // Disable workers to avoid yet another cross-origin issue (workers need the URL of
    // the script to be loaded, and dynamically loading a cross-origin script does
    // not work)
    //
    PDFJS.disableWorker = true;
    //
    // Asynchronous download PDF as an ArrayBuffer
    //
    var pdf = document.getElementById('pdf');
    pdf.onchange = function(ev) {
        if (file = document.getElementById('pdf').files[0]) {
            fileReader = new FileReader();
            fileReader.onload = function(ev) {
                PDFJS.getDocument(fileReader.result).then(function(pdf) {
                    for(var i = 1;i<=pdf.numPages;i++){
                        pdf.getPage(i).then(function(page) {
                            $('#magazine').append('<div><canvas id="the-canvas'+(page.pageIndex+1)+'" style="border:1px solid black;height:600px;width:600px"></canvas></div>');

                            var scale = 1.5;
                            var viewport = page.getViewport(scale);
                            var canvas = document.getElementById('the-canvas'+(page.pageIndex+1));
                            var context = canvas.getContext('2d');
                            canvas.height = viewport.height;
                            canvas.width = viewport.width;
                            var task = page.render({canvasContext: context, viewport: viewport});
                            task.promise.then(function(){
                                if (page.pageIndex == 4) {
                                    convertToFlipBook();
                                }
                            });
                        });
                    }
                }, function(error){
                    console.log(error);
                });

            };
            fileReader.readAsArrayBuffer(file);
        }
    }

    function convertToFlipBook(){
        $('#magazine').show().turn({
            width:1200,
            height:600,
            elevation: 50,
            gradients: true,
            autoCenter: true
        });
    }
</script>


<style id="jsbin-css">
</style>
<script>
</script>
</body>
</html>